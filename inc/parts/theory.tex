\chapter{Ground theory}
\section{Mail Transport\label{sec:mailTransport}}
Todays mail transport is mostly done via SMTP\index{SMTP} protocol as specified in \cite{RFC5321}. This protocol has proven to be stable and reliable. Most of the messages are passed from a MUA to a SMTP relay of a provider. From there the message is directly sent to the SMTP server of the recipient and from there to a server based storage of the recipient. The recipient may at any time connect to his server based storage and may optionally relocate the message to a client based (local) storage. The delivery from the server storage to the MUA of the recipient may happen by message polling or by message push (where as the later is usually implemented by a push-pull mechanism).\par

To understand the routing of a mail it is essential to understand the whole chain staring from a user(-agent) until arriving at the target user (and being read!). To simplify this I used a consistent model which includes all components (server and clients). The figure \ref{fig:MailAgents} shows all involved parties of a typical Mail routing. It is important to understand that Mail routing remains the same regardless of the used client. However -- Availability of a mail at its destination changes drastically depending on the type of client used. Furthermore control of the mail flow and control is different depending on the client.\par

The model has three main players storage (derfref{Storage}), agent (derfref{Agent}) and service (derfref{Service}). Storages are endpoint storages storing mails. Not explicitely shown are temporary storages such as spooler queues or state storages. Agents are simple programs taking care of a specific job. Agents may be exchangeable by other similar agents. A service is a bundle of agents which is responsible for a specific task or task sets.

\begin{figure}[ht!]
  \centering\includegraphics[width=\textwidth]{inc/MailAgents1}
  \caption{Mail Agents}
  \label{fig:MailAgents}
\end{figure}

In the following paragraphs (for definitions) the term ``Mail'' is used synonymously to the term ``Message''. The reason why ``Mail'' has been chosen over ``Messages'' that a lot of terms do already exist in standard documents. In these documents the term mail is commonly used.\par

Mails are typically initiated by a Mail User Agent (\defref{MUA}). A MUA accesses a local mail storage which may be the server storage or a local copy. The local copy may be a cache only copy, the only existing storage (when mails are fetched and deleted from the server after retrieval)  or a collected representation of multiple server storages (cache or authoritative).\par

Besides the MUA the only other component accessing a local mail storage is the Mail Delivery Agent (\defref{MDA}). An MDA is responsible for storing and fetching mails from the local mail storage. Mails destined for other accounts than the current one are forwarded to the MTA. In the case of a rich client the local MDA is part of the software provided by the user agent. In the case of a mail server the local MDA is part of the local Mailstore (not necessarily of the mail transport service).

On the server side there are usually two components (software sets) at work. A ``Mail Transport Service'' (\defref{MTS}) responsible for mail transfers and a ``Mail Storage System'' which offers the possibility to store received Mails in a local, persistent store.\par

A MTS consists generally out of three parts. For incomming connects there is a daemon called Mail Receiving Agent (\defref{Server MRA}) is typically a SMTP listening daemon. A Mail Transfer Agent (\defref{MTA}) which is responsible for routing, forwarding and rewriting mails. And a Mail Sending Agent (\defref{MSA}) which is responsible for transmitting mails to another Server MRA (usually done by SMTP).\par

A MSS consists out of a local storage and delivery agents which do offer uniform interfaces to access the local store.\par

\subsection{Mail user Agents}
Mail User Agents (MUA) are the terminal endpoint of a mail delivery. Mail user agents may be implemented as fat clients on a desktop or mobile system or as an interface over a different generic protocol such as HTTP (Web Clients). \par

Server located clients are a special breed of fat clients. These clients share the properties of fat clients except for the fact that they do not connect to the server. The client application itself has to be run on the server. This makes delivery and communication with the server different. Instead of interfacing with a MSA and a client MDA they may directly access the local mail storage on the server. On these systems the local mail storage may be implemented as a database in a user specific directory structure.

\subsubsection{Fat clients}
The majority of mail clients are fat clients. These clients score over the more centralistic organized web clients in the way that they may offer mail availability even if an internet connection is not available (thru a client specific local mail storage). They furthermore provide the possibility to collect mails from multiple sources and store them in the local storage. Unlike Mail servers, clients are assumed to be not always online. In fact they may be offline most of the time. To guarantee the availability of a certain email address a responsible mail server for a specific address collects all mails (this is done by the \defref{MSS}) and provides a consolidated view onto the database when a client connects thru a local or remote MDA.\par

As these clients vary strongly it is absolutely mandatory for the MDA that they are well specified. Lack in doing so would result in heavy interoperability problems. Most commonly the Protocols \defref{IMAP}, \defref{POP} and \defref{EWS} are being used these days. For mail delivery the SMTP protocol is used. \par

Fat clients ar comonly used on mobile devices. According to  \cite{clientDistribution} in Aug 2012 the most common fat email client was Apple Mail client on iOS devices ($35.6\%$), followed by Outlook ($20.14\%$), and Apple Mail ($11\%$). \citetitle{clientDistribution2}\cite{clientDistribution2} as a more recent source lists in February 2014 iOS devices with $37\%$, followed by Outlook ($13\%$), and  Google Android ($9\%$).

\subsubsection{Server located clients}
server located clients build an absolute minority. This kind of clients have been used mainly in the days of centralized hosts. An example for a Server Located Client is the Unix command "`mail"'. This client reads a mail storage from a file in the users home directory.

\subsubsection{Web clients}
Web clients are these days a common alternative to fat clients. Most big provider companies use their own proprietary web client. According to \cite{clientDistribution2} the most common web clients are "`Gmail"', "`Outlook.com"', and "`Yahoo! Mail"'. All these Interfaces do not offer a kind of public plugin interface. However,  they do offer IMAP-interfaces. This important for a future generalistic aproach to the problem.

\section{Anonymity}
Anonymity is according to Wikipedia\cite{wiki:anonymity} defined as follows:
\begin{quote}
Anonymity is derived from the Greek word anonymia, meaning "`without a name"' or "`namelessness"'. In colloquial use, anonymity typically refer to the state of an individual's personal identity, or personally identifiable information, being publicly unknown.
\end{quote}
A closely related but not identical term is "`Pseudonymity"' that is listed in Wikipedia as well as
\begin{quote}
Sometimes it is desired that a person can establish a long-term relationship (such as a reputation) with some other entity, without necessarily disclosing personally identifying information to that entity. In this case, it may be useful for the person to establish a unique identifier, called a pseudonym, with the other entity. Examples of pseudonyms are pen names, nicknames, credit card numbers, student numbers, bank account numbers, and IP addresses. A pseudonym enables the other entity to link different messages from the same person and, thereby, the maintenance of
a long-term relationship. \par
Someone using a pseudonym would be strictly considered to be using "pseudonymity" not "anonymity", but sometimes the term "anonymity" is used to refer to both (in general, a situation where the legal identity of the person is disguised).
\end{quote}
and under the "`Pseudonymity"' \cite{wiki:pseudonymity} entry:
\begin{quote}
The pseudonym identifies a holder, that is, one or more human beings who possess but do not disclose their true names (that is, legal identities). Most pseudonym holders use pseudonyms because they wish to remain anonymous, but anonymity is difficult to achieve, and is often fraught with legal issues.[2] True anonymity requires unlinkability, such that an attacker's examination of the pseudonym holder's message provides no new information about the holder's true name.
\end{quote}

\subsection{\itshape{k}-anonymity}
In \citetitle{k-anonymous:ccs2003}\cite{k-anonymous:ccs2003} \citeauthor{k-anonymous:ccs2003} outline that a individual in most of the cases does not have to be completely anonymous. Instead it might be sufficient to blend into a group of $k$ identities. in \cite{wpes10-unraveling} \citeauthor{wpes10-unraveling} do show that this is not always sufficient. 

\subsection{Plausible deniability}
According to Wikipedia\cite{wiki:plausibleDeniability} "`Plausible Deniability refers to "`... a term coined by the CIA in the early 1960s to describe the withholding of information from senior officials in order to protect them from repercussions in the event that illegal or unpopular activities by the CIA became public knowledge. [...]  The lack of evidence to the contrary ostensibly makes the denial plausible, that is, credible. The term typically implies forethought, such as intentionally setting up the conditions to plausibly avoid responsibility for one's (future) actions or knowledge."'\par

In this work we use the term ...
FIXME incomplete section

\subsubsection{Deniable encryption}
In Wikipedia\cite{wiki:deniableEncryption} "`Deniable Encryption"' is defined as
\begin{quote}
In cryptography and steganography, plausibly deniable encryption is encryption that allows its users to convincingly deny that some specific encrypted data exists, that a given piece of data is encrypted, or that they are able to decrypt a given piece of encrypted data.
\end{quote}

\cite{ccs2011-cirripede}
\cite{truecryptDFS}

FIXME incomplete section

\subsection{DC-Nets}
\cite{chaum-dc}
FIXME incomplete section

\section{Identification and data signage}
FIXME incomplete section

\section{Steganography}
\cite{wiki:steganographie}
\cite{f5}
\cite{steganalysisf5}
FIXME incomplete section

\section{Encryption}
FIXME incomplete section

\subsection{Symetric encryption}
FIXME incomplete section

\subsubsection{Advanced Encryption Standard}
FIXME incomplete section

\subsection{Asymetric encryption}
FIXME incomplete section

\subsubsection{RSA}
FIXME incomplete section

\subsubsection{El-Gamal}
FIXME incomplete section

\subsubsection{ECDSA}
FIXME incomplete section

\subsection{Key exchange}
FIXME incomplete section

\subsubsection{Diffie-Hellmann key exchange}
FIXME incomplete section

\section{Mix cascades}
FIXME incomplete section

\section{Remailers}
Agents which do accept Mails from one party and forward it to another party while modifying its content well known under the name of ``Remailers''. Wi\-ki\-pe\-dia \cite{wiki:remailer} lists four types of Remailers.\par

Pseudonymous Remailers (or Type-0-Remailers) are remailers that establish a pseu\-do\-ny\-mi\-ty. This means that the senders Email-Address is removed and replaced by a pseudonymous E-Mailadress under the remailers control. This sender address may be used as an ordinary email-Adress to reeach the original sender of the mail. These types of Remailers allow to send mails while one or both recipients do not know their counterpart. The message (or at least parts of it) might be encrypted but do not have to be. For someone controling the Remailer it will always be possible to make a link between the pseudonymous mail address and a original mailadress. So pseudonymity is only granted towards people not controlling the remailer. Furthermore a person or organisation might be able to discover the Information tuple of Sender and pseudonymous email by analyzing messages and their timely context. So this remailer system is suspectible for traffic analysis.\par

Cypherpunk-Remailers (or Type-1-Remailers) do function a bit different. They take an encrypted message which was encrypted using the public key of the server, decrypt it and send it to a recipient. The original senders identity gets lost. A reply to a cypherpunk message is not possible. Messages sent to a cypherpunk server might contain messages to other cypherpunk remailers. This daisy-chaining of cypherpunk-nodes allows hiding the original sender-receiver-tuple from a single node. The first node knows only the the originating sender while the last node knows only the final recipient. All intermediate notes do only know the nodes they were linking. However if having traffic information of the entry and exit nodes the tuple might be discovered by traffic analysis.\par

Mixmaster remailer (or type-2-remailer) is a serie of mailers which split up a message into equally sized chunks and forward them using different paths (via SMTP) to an exit node where the message is reassembled and sent to the final recipient. However if having traffic information of the entry and exit nodes the tuple might be discovered by traffic analysis.\par

Mixminion remailer (or type-3-remailer) is an enhanced development of Mixmaster remailer. It is currently no longer under active development. It adresses serveral weaknesses of the mixmaster. Namely replies are possible. Forward anonymity is now given. Replay prevention and key rotation is part of the design and there are exit policies allowing ISPs to opt out from receiving remailer traffic. It is based on a proprietary communication network. It furthermore introduces dummy traffic to reduce traceability. This is the most complete approach email anonymity ever given. The aproach has however its weaknesses. To avoid partitioning attacks Miximinon distributes its network information with central redundant directory servers.\par

\section{Ethics}
\subsection{Human rights}
\subsubsection{Freedom of speech}
Article 19 of the ICCPR states that "everyone shall have the right to hold opinions without interference" and "everyone shall have the right to freedom of expression; this right shall include freedom to seek, receive and impart information and ideas of all kinds, regardless of frontiers, either orally, in writing or in print, in the form of art, or through any other media of his choice".

\subsection{Ethics of the Internet}
There is an RFC document regarding ``Ethics and the Internet''\cite[p.~1]{RFC1087}. Document states as unethical behaveour:
\begin{itemize}
\item An activity that seeks to gain unauthorized access to the resources of the Internet.
\item An activity that disrupts the intended use of the Internet.
\item An activity that wastes resources (people, capacity, computer) through such actions.
\item An activity that destroys the integrity of computer-based information.
\item An activity that compromises the privacy of users.
\end{itemize}
Unfortunately these actions do exist in modern internet and the most powerful players discovered so far are governmental agencies. Using a mixer and cryptographic algorithms definitely wastes resources. But it must be considered the right of every single user of the internet to uphold these points. As a final conclusion the proposed system does not violate the ethics of the internet but it must be designed to be as economically as possible with the existing resources.

\section{Possible legal issues}
One of the first questions I have been asked when working for this topic was: Is this legal? The question is important but not easy at all. The mail system is a global spanning network coming across almost any country of the world. Some of these countries consider almost any kind of secret as illegal as long as the country itself is not able to capture it. Some countries consider it as perfectly legal and some will generally accept its presence as long as the country or establishment is not endangered due to its usage. Since there is usually control about mail traffic flow there is no mean to tell what laws have been violated by sending a mail. This is not specific to this work but a general problem which occurs often in connection to the internet.\par

To give some examples of illegality:
\begin{itemize}
\item Bahrain\\
According to \url{http://www.cryptolaw.org} cryptography is not allowed in telecommunications networks using the radio frequency spectrum (see Section 50 Paragraph 2 of the 2002 Telecommunications Law \cite{BAHRAIN})
\item Hungary\\
According to \url{http://www.cryptolaw.org} a provision in the Hungarian Digital Signature Act, which entered into force on 1 September 2001, holds that signature-creation data (such as a cryptographic key) shall not be used for other purposes than signing. The ministerial reasoning explains that the intention of this is to prohibit the use of private keys for cryptographic purposes, in the interest of national security. (Note that cryptographic keys not used for creating signatures can be used for encrypting.)
\item Moroco\\
According to \citetitle{MAROCO}\cite{MAROCO} all cryptography used for encryption of content is illegal in Morocco unless you have a license issued by the government.
\item Russia\\
According to \url{http://www.cryptolaw.org} almost all cryptography is illegal in  Russia unless you have a license issued by FSB.
\end{itemize}
