<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
        <!ENTITY RFC2119 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
        <!ENTITY RFC3501 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3501.xml">
        <!ENTITY RFC5321 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5321.xml">
        <!ENTITY RFC6120 SYSTEM "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6120.xml">
        ]>

<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>

<!-- For a complete list and description of processing instructions (PIs),
    please see http://xml.resource.org/authoring/README.html. -->
<?rfc strict="yes" ?>
<?rfc toc="yes"?>
<?rfc tocdepth="4"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes" ?>
<?rfc compact="yes" ?>
<?rfc subcompact="no" ?>

<rfc category="exp" docName="draft-ietf-messagevortex-protocol-00" ipr="trust200902">
<!-- category values: std, bcp, info, exp, and historic
    ipr values: trust200902, noModificationTrust200902, noDerivativesTrust200902, or pre5378Trust200902 you can add the attributes updates="NNNN" and obsoletes="NNNN" they will automatically be output with "(if approved)"
-->

    <front>
        <!-- The abbreviated title is used in the page header - it is only necessary if the full title is longer than 39 characters -->

        <title>MessageVortex Protocol</title>

        <author fullname="Martin Gwerder" surname="Gwerder">
            <address>
                <postal>
                    <street>Untere Parkstrasse 9</street>
                    <code>5212</code><city>Hausen</city><region>AG</region>
                    <country>Switzerland</country>
                </postal>
                <phone>+41 56 202 76 81</phone>
                <email>rfc@messagevortex.net</email>

            </address>
            </author>

        <date year="2018"/>

        <area>General</area>

        <workgroup>Internet Engineering Task Force</workgroup>

        <!-- WG name at the upperleft corner of the doc,
             IETF is fine for individual submissions.
          If this element is not present, the default is "Network Working Group",
             which is used by the RFC Editor as a nod to the history of the IETF. -->

        <keyword>SMTP</keyword>
        <keyword>XMPP</keyword>
        <keyword>IMAPrev4</keyword>
        <keyword>MessageVortex</keyword>
        <keyword>Anonymity</keyword>

        <abstract>
            <t>
                MessageVortex Protocol specifies messages that may be embedded into existing message transfer protocols such  as SMTP (<xref target="RFC5321">RFC 5321</xref>) or XMPP (<xref target="RFC6120">RFC 6120</xref>) in order to send them anonymously from peer to peer.
            </t>
            <t>
                The protocol outperforms other protocols by completely decoupling transport from the final transmitter and      receiver party. There is no trust put into any infrastructure except for the infrastructure of the sending and receiving party of a message. Message flow is entirely selected by the creator of the routing block. Participating routing nodes gain no unobvious knowledge about messages even when collaborating. Third party anonymity may be always achieved. Furthermore one out of sender, and receiver anonymity may be achieved as well.
            </t>
        </abstract>
    </front>

    <middle>
        <section title="Introduction">
            <t>Anonymization is hard to achieve. Many attempts have been made but most of them do rely on either a trust upon a dedicated infrastructure, or a specialized networking protocol.</t>
            <t>
                MessageVortex is a protocol which allows to send and receive messages by using a routing block instead of a destination address.
                The routing block is built in such a way that it gives the sender full control over a path a message follows.
            </t>
            <t>
                During transmission a message is continuousl split and reassembled. The operations are built in such a way that they generate either valid traffic or decoy traffic. A generating node is therefore unable to differentiate between the message and decoy traffic.
            </t>
            <t>
                Any Receiver knows after processing whether a message is destined for it or for other nodes.
            </t>
            <t>
                This RFC is structured in such a way that first the terminology is introduced (see <xref target="entities_overview"/>). Next a general overview over the process is given (see <xref target="layer_overview"/>). Lastly the protocol is described in details in the subsequent sections.
            </t>

            <section title="Requirements Language">
                <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <xref target="RFC2119">RFC 2119</xref>.</t>
            </section>
        </section>

        <section anchor="entities_overview" title="Entities Overview">
            <t>Within these document we refer to the entities as defined below. </t>
	        <section anchor="entities_node" title="Node">
	            <t>We use the term 'node' to  describe any system connected to other nodes, and supporting the MessageVortex Protocol.</t>
	        </section>
	        <section anchor="entities_peer" title="Peer Partner">
	            <t>We use the term 'peer partner' as two or more message sending or receiving entities. One of these peer partners is the sends a message and all other peer partner do receive a message. Peer partners are message specific. Every peer partner is connected to a node.</t>
        	</section>
            <section anchor="entities_vortex_message" title="Vortex Message">
                <t>
                    We use the term 'Vortex message' for a single transmission between two routing layers. A 'blended Vortex message' describes a Vortex message which has been adapted to the transport layer by the blending layer (see <xref target="layer_overview"/>
                </t>
                <t>
                    A Vortex message may be sent anonymously. There are however different degrees of anonymity.

                    <list style="symbols">
                        <t>If the sender of a message is not known to anyone else except the sender we refer to that as sender anonymity.</t>
                        <t>If the receiver of a message is not known to anyone else except the receiver we refer to that as receiver anonymity.</t>
                        <t>If neither sender nor receiver can be determined by any other party we refer to that as thrd party anonymity.</t>
                        <t>If a sender or a receiver may be determined as "one aout of a set of &lt;k&gt; entities we refer to it as k-anonymity (for more about this see <xref target="KANON"/>).</t>
                    </list>
                </t>
            </section>
            <section anchor="entities_blocks" title="Blocks">
                <t>We use the term 'block' for an ASN.1 sequence in a packet.  A packet may have any size and and is embedded in the transport protocol. It must not be confused with network packets.</t>
            </section>
            <section anchor="entities_transport_address" title="Transport Address">
                <t>We use the term 'transport adress' for the address required to address the next immediate node on the transport layer.  An email transport layer would have SMTP addresses such as vortex@example.com as transport address.</t>
            </section>
            <section anchor="entities_identity" title="Identity">
                <section anchor="entities_identity_peer" title="Peer Identity">
                    <t>The peer identity may contain the following information of a peer partner:
                        <list style="symbols">
                            <t>Transport address and public key of this identity (if no recipient anonymity is given)</t>
                            <t>Reply blocks for contacting the identity (optional; usually in case of recipient annonymity)</t>
                            <t>Private key (only known by owner of the identity)</t>
                        </list>
                    </t>
                </section>
                <section anchor="entities_identity_ephemeral" title="Ephemeral Identity">
                    <t>Ephemeral identities are temporary identities created on a single node. These identities MUST NOT be connected to any other identity. They allow book keeping for a node. To each ephemeral identity is a workspace assigned. Every ephemeral identity may have multiple quota assigned.
                    </t>
                </section>
                <section anchor="entities_identity_official" title="Official Identity">
                    <t>An official identity may have the following items assigned:
                        <list style="symbols">
                            <t>Reply blocks to be used.</t>
                            <t>A list of assigned ephemeral identities on all other nodes and their projected quotas.</t>
                            <t>A list of known nodes and the respective node identity</t>
                        </list>
                    </t>
                </section>
            </section>
            <section anchor="entities_workspace" title="Workspace">
                <t>Every official or ephemeral identity has a workspace. A workspace consists out of the following elements:
                    <list style="symbols">
                        <t>Zero or more routing blocks to be processed</t>
                        <t>Slots for payload block sequencially numbered</t>
                    </list>
                </t>
            </section>
        </section>

        <section anchor="layer_overview" title="Layer Overview">
            <t>The protocol is designed in four layers as shown in <xref target="fig_layer_overview" /></t>

            <figure align="center" anchor="fig_layer_overview">
                <artwork align="center"><![CDATA[
+-------------------------------------------------------------------+
| Vortex Node                                                       |
| +---------------------------------------------------------------+ |
| |                        Accounting                             | |
| |_______________________________________________________________| |
|                                                                   |
| +---------------------------------------------------------------+ |
| |                          Routing                              | |
| |_______________________________________________________________| |
|                                                                   |
| +----------------------------+ +--------------------------------+ |
| |           Blending         | |             Blending           | |
| |____________________________| |________________________________| |
|___________________________________________________________________|
  +----------------------------+ +--------------+ +---------------+
  |          Transport         | | Transport in | | Transport out |
  |____________________________| |______________| |_______________|
               ]]></artwork>
            </figure>

	        <t>
                Every participating node MUST implement the layers 'Blending', 'Routing', and 'Accounting'.  There MUST be at least one incomming and one outgoing transport layer available to a node. All blending layers SHOULD be connected to respective Transport layers for sending and receiving packets.
            </t>

            <section anchor="layer_overview_transport" title="Transport Layer">
	            <t>The transport layer embedds the blended MessageVortex packets into the data stream of the existing transport layer protocol.</t>
                <t>The transport layer infrastructure SHOULD NOT be specific to anonymous communication and should contain significant parts of non-MessageVortex traffic.</t>
	        </section>

            <section anchor="layer_overview_blending" title="Blending Layer">
	            <t>The blending layer embedds MessageVortex packets into the transport layer data stream and extracts MessageVortex packets from the transport layer.</t>
	        </section>
	        <section anchor="layer_overview_routing" title="Routing Layer">
	            <t>The Routing Layer expands information contained in MessageVortex packets, processes them, and passes generated  packets to the respective Blending Layer.</t>
	        </section>
	        <section anchor="layer_overview_accounting" title="Accounting Layer">
	            <t>The accounting layer keeps track of all ephemeral identities authorized to use a MessageVortex node. Especially it verifies the available quotas to an ephemeral identity.
                </t>
	        </section>
        </section>

        <section anchor="blending" title="Blending">
            <t>Each node supports a fixed set of belnding capabilities. They may be different for incomming and outgoing messages.
            </t>
            <t>The following sections describe the s 
            <section anchor="blending_smtp" title="Blending into an SMTP layer">
                <t>For interoperability this layer MUST be implemented. </t>
            </section>
            <section anchor="blending_xmmp" title="Blending into an XMMP layer">
                <t>For interoperability this layer SHOULD be implemented</t>
            </section>
        </section>

        <section anchor="routing" title="Routing">
            <section anchor="routing_message" title="Vortex Message Processing">
                <section anchor="routing_incomming" title="Processing of incomming Vortex Messages">
                    <t>FIXME</t>
                </section>
                <section anchor="routing_workspace" title="Processing of Routing Blocks in Workspace">
                    <t>FIXME</t>
                </section>
                <section anchor="routing_outgoing" title="Processing of Outgoing Routing Blocks">
                    <t>FIXME</t>
                </section>
            </section>
            <section anchor="routing_header" title="Header Requests">
                <section anchor="routing_header_eid" title="Request New Ephemeral Identity">
                    <t>FIXME</t>
                </section>
                <section anchor="routing_header_req_msg_quota" title="Request Message Quota">
                    <t>FIXME</t>
                </section>
                <section anchor="routing_header_req_trans_quota" title="Request Transfer Quota">
                    <t>FIXME</t>
                </section>
                <section anchor="routing_header_qry_quota" title="Query Quota">
                    <t>FIXME</t>
                </section>
                <section anchor="routing_header_req_cap" title="Request Capabilities">
                    <t>FIXME</t>
                </section>
                <section anchor="routing_header_req_nodes" title="Request Nodes">
                    <t>FIXME</t>
                </section>
                <section anchor="routing_header_req_rb_replace" title="Request Routing Block Replace">
                    <t>FIXME</t>
                </section>
            </section>
            <section anchor="routing_operations" title="Routing Operations">
                <t>FIXME</t>
            </section>
            <section anchor="routing_processing" title="Processing of Vortex Messages">
                <t>FIXME</t>
            </section>
        </section>

        <section anchor="accounting" title="Accounting">
            <section anchor="accounting_create_identity" title="Ephemeral identity creation">
                <t>The accounting layer has two major kinds of operations:
                    <list style="symbols">
                        <t>Time based operations (cleanup jobs and initiation of routing)</t>
                        <t>Routing triggered operations (updating quotas, authorizing operations, and pickup of incomming messages.)</t>
                    </list>

                    Implementations MUST provide sufficient locking mechanisms to guarantee integrity of accounting information and workspace at any time.
                </t>
                <section anchor="accounting_timed" title="">
                    <t>FIXME</t>
                </section>
            </section>
        </section>

        <section anchor="Acknowledgements" title="Acknowledgements">
            <t>FIXME</t>
        </section>

        <section anchor="IANA" title="IANA Considerations">
            <t>This memo includes no request to IANA.</t>

            <t>Additional encryption algorithms, paddings, modes, blendinmg layers, or puzzles MUST be added writing an extension to this or a subsequent RFC. For testing purposes IDs above 1,000,000,000 should be used.</t>
        </section>

        <section anchor="Security" title="Security Considerations">
            <t>The MessageVortex protocol may be understood more as a toolset than a fixed product. Depending on the usage of the tool set anonymity and security are affected. For a detailed analysis see <xref target="MessageVortexAnalysis"/>.
            </t>
            <t>
                The primary goals for security with in this protocol did rely on the following focus areas:
                <list style="symbols">
                    <t>Confidentiality</t>
                    <t>Integrity</t>
                    <t>Availability</t>
                    <t>Anonymity
                        <list style="symbols">
                            <t>3rd party anonymity</t>
                            <t>3rd party anonymity</t>
                        </list>
                    </t>
                </list>

                All these factors are affected by the usage of the protocol. The following sections provide a list of factors affecting the primary goals.
            </t>

        </section>
    </middle>

    <!--  *****BACK MATTER ***** -->

    <back>
        <references title="Normative References">
            <!--?rfc include="http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml"?-->
            &RFC2119;

            <reference anchor="CCITT.X208.1988">
                <front>
                    <title>Specification of Abstract Syntax Notation One (ASN.1)</title>
                    <author>
                        <organization>International Telephone and Telegraph Consultative Committee</organization>
                    </author>
                    <date year="1998" month="11"/>
                </front>
                <seriesInfo name="CCITT Recommendation" value="X.208"/>
            </reference>

            <reference anchor="CCITT.X680.2002">
                <front>
                    <title>Abstract Syntax Notation One (ASN.1): Specification of basic notation</title>
                    <author>
                        <organization>International Telephone and Telegraph Consultative Committee</organization>
                    </author>
                    <date year="2002" month="11"/>
                </front>
                <seriesInfo name="CCITT Recommendation" value="X.680"/>
            </reference>

        </references>

        <references title="Informative References">
            <!-- Here we use entities that we defined at the beginning. -->
            &RFC6120;
            &RFC5321;

            <!-- A reference written by by an organization not a person. -->
            <reference anchor="MessageVortexAnalysis" target="https://www.gwerder.net/phd/phd/doc/messageVortex.pdf">
                <front>
                    <title>MessageVortex</title>
                    <author initials="M" surname="Gwerder">
                        <organization></organization>
                    </author>
                    <date year="2018" />
                </front>
            </reference>

            <reference anchor="KANON">
                <front>
                    <title>k-Anonymous Message Transmission</title>
                    <author initials="L" surname="Ahn">
                        <organization>Carnegie Mellon University</organization>
                    </author>
                    <author initials="A" surname="Bortz">
                        <organization>Carnegie Mellon University</organization>
                    </author>
                    <author initials="NJ" surname="Hopper">
                        <organization>Carnegie Mellon University</organization>
                    </author>
                    <date year="2003" />
                </front>
            </reference>

        </references>

        <section anchor="asn_one" title="The ASN.1 schema for Vortex messages">
            <t>This becomes an Appendix.</t>
        </section>
        <!-- Change Log

            v00 2018-04-19  GwM   Initial version

        -->
    </back>
</rfc>
